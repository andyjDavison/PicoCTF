# Guessing Game 1

## Description
I made a simple game to show off my programming skills. See if you can beat it!

## Challenge Information
**Point Value:** 250  
**Category:** Binary Exploitation

## Hints
1. Tools can be helpful, but you may need to look around for yourself.
2. Remember, in CTF problems, if something seems weird it probably means something...

## Solution
We are given a c++ file and to be able to see the source code of the game:
```c++
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>

#define BUFSIZE 100


long increment(long in) {
        return in + 1;
}

long get_random() {
        return rand() % BUFSIZE;
}

int do_stuff() {
        long ans = get_random();
        ans = increment(ans);
        int res = 0;

        printf("What number would you like to guess?\n");
        char guess[BUFSIZE];
        fgets(guess, BUFSIZE, stdin);

        long g = atol(guess);
        if (!g) {
                printf("That's not a valid number!\n");
        } else {
                if (g == ans) {
                        printf("Congrats! You win! Your prize is this print statement!\n\n");
                        res = 1;
                } else {
                        printf("Nope!\n\n");
                }
        }
        return res;
}

void win() {
        char winner[BUFSIZE];
        printf("New winner!\nName? ");
        fgets(winner, 360, stdin);
        printf("Congrats %s\n\n", winner);
}

int main(int argc, char **argv){
        setvbuf(stdout, NULL, _IONBF, 0);
        // Set the gid to the effective gid
        // this prevents /bin/sh from dropping the privileges
        gid_t gid = getegid();
        setresgid(gid, gid, gid);

        int res;

        printf("Welcome to my guessing game!\n\n");

        while (1) {
                res = do_stuff();
                if (res) {
                        win();
                }
        }

        return 0;
}
```
We are also given a Makefile:
```make
all:
        gcc -m64 -fno-stack-protector -O0 -no-pie -static -o vuln vuln.c

clean:
        rm vuln
```
We are also given a binary, but I chose not to look at it for now. After looking for some time the idea of the game is simple, the program creates a random number, and if you guess it you win. However I noticed the use of the function rand(). No where in the program is the seed set with srand(), so we know it is most likely not a real random number and in fact is just a number between 1 and 100.


## Flag